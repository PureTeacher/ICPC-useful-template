## 裴蜀定理（贝祖定理）

任意两个数 $a$ 和 $b$ 作加减，可得所有 $gcd(a,b)$ 倍数，得不到其他数。
$$
k_1 a + k_2 b = x \\
\begin{array}{l}
1)~若~x=k\cdot\gcd(a,b),~方程一定有解; \\
2)~若~x\neq k\cdot\gcd(a,b),~方程一定无解; \\
\end{array}
$$



## 费马小定理

对于任意数 $a$ 和质数 $p$，满足费马小定理。
$$
a^{p-1} \equiv 1 \pmod{p}
$$



## Wilson 定理

对于质数 $p$，满足 Wilson 定理。
$$
(p-1)! \equiv -1 \pmod{p}
$$



## Lucas 定理

对于质数 $p$，满足 Lucas 定理。
$$
\binom{n}{m} \equiv \binom{\lfloor{n/p}\rfloor}{\lfloor{m/p}\rfloor} \cdot \binom{n\%p}{m\%p}\pmod{p}
$$



## 范德蒙德卷积

$$
\sum_{i=0}^{n}{\binom{a}{i}\binom{b}{n-i}}=\binom{a+b}{n}
$$

* 解释：从 $a$ 个不同的球的箱子中取任意个球，从 $b$ 个不同的球的箱子中取任意个球，恰好共取 $n$ 个球的情况数。这与从 $a+b$ 个不同的球中取 $n$ 个球的情况数是相同的。

* 推论（常用）：

$$
\sum_{i=0}^{n}{\binom{n}{i}\binom{m}{i}}=\binom{n+m}{n}
$$

$$
\sum_{i=0}^{n}{\binom{n}{i}^2}=\binom{2n}{n}
$$



## 多项式降幂

对于模 $p$ 意义上的多项式 $f(x)$ 满足：
$$
f(x)^k \equiv f(x^p)^{\lfloor{k/p}\rfloor} \cdot f(x)^{k\%p} \pmod{p}
$$

基于此，若 $n \le p$，设多项式 $f(x)$ 的常数项为 $a_0$，则有：
$$
f(x)^k \equiv a_0^{\lfloor{k/p}\rfloor} \cdot f(x)^{k\%p} \pmod{p}\pmod{x^n}
$$
对第一部分使用欧拉降幂，第二部分使用 NTT 快速幂，时间复杂度为 $O(n\log_2{n}\log_2{p})$。



## 多项式求逆

对于多项式 $f(x)$ 可以递推求逆，使用数学归纳法证明：
$$
\begin{array}{ll}
设~A \equiv f(x), \\
1)~当~n=1~时, & A^{-1} \equiv a_0^{-1} \pmod{p}\pmod{x^n} \\
2)~当~n>1~时, & 设~I~ \equiv A^{-1} \pmod{p}\pmod{x^{\lceil\frac{n}{2}\rceil}} & (已知) \\
& 设~I' \equiv A^{-1} \pmod{p}\pmod{x^n} & (所求) \\
\end{array}
$$

$$
\begin{array}{rrl}
& A \cdot (I'-I) & \equiv 0 \pmod{x^{\lceil\frac{n}{2}\rceil}} \\
f(x) \neq 0, & I'-I~ & \equiv 0 \pmod{x^{\lceil\frac{n}{2}\rceil}} \\
左右平方, & I'^2-2II'+I^2 & \equiv 0 \pmod{x^n} \\
同乘原式, & I'-2I+I^2A & \equiv 0 \pmod{x^n} \\
移项, & I' & \equiv 2I-I^2A \pmod{x^n} \\
\end{array}
$$

由于每项倍增，时间复杂度为 $O(n \log_2{n})$。
